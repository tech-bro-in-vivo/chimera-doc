(window.webpackJsonp=window.webpackJsonp||[]).push([[427],{672:function(t,a,e){"use strict";e.r(a);var o=e(3),r=Object(o.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"授权"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#授权"}},[t._v("#")]),t._v(" 授权")]),t._v(" "),e("p",[t._v("部分接口需要经过用户授权同意才能调用。我们把这些接口按使用范围分成多个 "),e("code",[t._v("scope")]),t._v(" ，用户选择对 "),e("code",[t._v("scope")]),t._v(" 来进行授权，当授权给一个 "),e("code",[t._v("scope")]),t._v(" 之后，其对应的所有接口都可以直接使用。")]),t._v(" "),e("p",[t._v("此类接口调用时：")]),t._v(" "),e("ul",[e("li",[t._v("如果用户未接受或拒绝过此权限，会弹窗询问用户，用户点击同意后方可调用接口；")]),t._v(" "),e("li",[t._v("如果用户已授权，可以直接调用接口；")]),t._v(" "),e("li",[t._v("如果用户已拒绝授权且勾选了不再询问，则不会出现弹窗，而是直接进入接口 fail 回调。")])]),t._v(" "),e("h3",{attrs:{id:"获取用户授权设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取用户授权设置"}},[t._v("#")]),t._v(" 获取用户授权设置")]),t._v(" "),e("p",[t._v("开发者可以使用 "),e("router-link",{attrs:{to:"/api/open-api/setting/qa.getSetting.html"}},[t._v("qa.getSetting")]),t._v(" 获取用户当前的授权状态。")],1),t._v(" "),e("h3",{attrs:{id:"打开设置界面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#打开设置界面"}},[t._v("#")]),t._v(" 打开设置界面")]),t._v(" "),e("p",[t._v("用户可以在快应用设置界面（「右上角」 - 「关于」 - 「右上角」 - 「设置」）中控制对该快应用的授权状态。")]),t._v(" "),e("h3",{attrs:{id:"提前发起授权请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提前发起授权请求"}},[t._v("#")]),t._v(" 提前发起授权请求")]),t._v(" "),e("p",[t._v("开发者可以使用 "),e("router-link",{attrs:{to:"/api/open-api/authorize/qa.authorize.html"}},[t._v("qa.authorize")]),t._v(" 在调用需授权 API 之前，提前向用户发起授权请求。")],1),t._v(" "),e("h3",{attrs:{id:"scope-列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#scope-列表"}},[t._v("#")]),t._v(" scope 列表")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("scope")]),t._v(" "),e("th",[t._v("对应接口")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("scope.userInfo")]),t._v(" "),e("td",[e("router-link",{attrs:{to:"/api/open-api/user-info/qa.getUserInfo.html"}},[t._v("qa.getUserInfo")])],1),t._v(" "),e("td",[t._v("用户信息")])]),t._v(" "),e("tr",[e("td",[t._v("scope.userLocation")]),t._v(" "),e("td",[e("router-link",{attrs:{to:"/api/location/qa.getLocation.html"}},[t._v("qa.getLocation")]),t._v(", "),e("router-link",{attrs:{to:"/api/location/qa.chooseLocation.html"}},[t._v("qa.chooseLocation")])],1),t._v(" "),e("td",[t._v("地理位置")])]),t._v(" "),e("tr",[e("td",[t._v("scope.record")]),t._v(" "),e("td",[e("router-link",{attrs:{to:"/api/media/recorder/qa.startRecord.html"}},[t._v("qa.startRecord")])],1),t._v(" "),e("td",[t._v("录音功能")])]),t._v(" "),e("tr",[e("td",[t._v("scope.writePhotosAlbum")]),t._v(" "),e("td",[e("router-link",{attrs:{to:"/api/media/image/qa.saveImageToPhotosAlbum.html"}},[t._v("qa.saveImageToPhotosAlbum")]),t._v(", "),e("router-link",{attrs:{to:"/api/media/video/qa.saveVideoToPhotosAlbum.html"}},[t._v("qa.saveVideoToPhotosAlbum")])],1),t._v(" "),e("td",[t._v("保存到相册")])])])]),t._v(" "),e("h3",{attrs:{id:"授权有效期"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#授权有效期"}},[t._v("#")]),t._v(" 授权有效期")]),t._v(" "),e("p",[t._v("一旦用户明确同意或拒绝过授权，其授权关系会记录在后台，直到用户主动删除快应用。")]),t._v(" "),e("h3",{attrs:{id:"最佳实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),e("p",[t._v("在真正需要使用授权接口时，才向用户发起授权申请，并在授权申请中说明清楚要使用该功能的理由。")]),t._v(" "),e("h3",{attrs:{id:"注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),e("ol",[e("li",[e("code",[t._v('qa.authorize({scope: "scope.userInfo"})')]),t._v("，不会弹出授权窗口，请使用 "),e("router-link",{attrs:{to:"/component/button.html"}},[e("code",[t._v('<button open-type="getUserInfo"/>')])])],1),t._v(" "),e("li",[t._v("需要授权 "),e("code",[t._v("scope.userLocation")]),t._v(" 时必须"),e("router-link",{attrs:{to:"/reference/configuration/app.html#permission"}},[t._v("配置地理位置用途说明")]),t._v("。")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);