<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>事件 | 快应用 (Light) 版</title>
    <meta name="description" content="快应用light版官方文档, 标准是由主流手机厂商组成的快应用联盟联合制定,其标准的诞生将在研发接口、能力接入、开发者服务等层面建设标准平台，以平台化的生态模式对个人开发者和企业开发者全品类开放。快应用具备传统 APP 完整的应用体验，无需安装、即点即用；覆盖 10 亿设备，与操作系统深度集成，探索新型应用场景。本章的内容为事件">
    <link rel="icon" href="/quickapp.ico">
  <link rel="manifest" href="/manifest.json">
    <meta property="og:site_name" content="快应用 (Light) 版"><meta property="og:title" content="事件"><meta property="og:type" content="website"><meta property="og:url" content="/framework/view/event.html"><meta name="twitter:title" content="事件"><meta name="twitter:url" content="/framework/view/event.html"><meta name="twitter:card" content="summary_large_image"><meta name="keyword" content="快应用light版, quickapp, fastapp, 小程序, 原生应用, 即点即用事件,快应用 (Light) 版">
    <link rel="preload" href="/assets/css/0.styles.dbb4866b.css" as="style"><link rel="preload" href="/assets/js/app.2978aa4c.js" as="script"><link rel="preload" href="/assets/js/4.f7bb38b0.js" as="script"><link rel="preload" href="/assets/js/454.edfe2275.js" as="script"><link rel="preload" href="/assets/js/8.31dc05a6.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.dbb4866b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/quick-app-logo.2e96865f.png" alt="快应用 (Light) 版" class="logo"> <span class="site-name">快应用 (Light) 版</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">教程</a></div><div class="nav-item"><a href="/reference/" class="nav-link">框架</a></div><div class="nav-item"><a href="/component/" class="nav-link">组件</a></div><div class="nav-item"><a href="/api/" class="nav-link">API</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">教程</a></div><div class="nav-item"><a href="/reference/" class="nav-link">框架</a></div><div class="nav-item"><a href="/component/" class="nav-link">组件</a></div><div class="nav-item"><a href="/api/" class="nav-link">API</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>快速开始</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/quickstart/introduction.html" class="sidebar-link">快应用(Light)介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/quickstart/introduction.html#快应用-light-是什么？" class="sidebar-link">快应用(Light)是什么？</a></li></ul></li><li><a href="/framework/quickstart/getstart.html" class="sidebar-link">开始开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/quickstart/getstart.html#安装开发工具" class="sidebar-link">安装开发工具</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/getstart.html#创建项目" class="sidebar-link">创建项目</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/getstart.html#真机预览调试" class="sidebar-link">真机预览调试</a></li></ul></li><li><a href="/framework/quickstart/code.html" class="sidebar-link">代码构成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/quickstart/code.html#json-配置" class="sidebar-link">JSON 配置</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/code.html#qxml-模板" class="sidebar-link">QXML 模板</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/code.html#样式" class="sidebar-link">样式</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/code.html#js-逻辑交互" class="sidebar-link">JS 逻辑交互</a></li></ul></li><li><a href="/framework/quickstart/framework.html" class="sidebar-link">运行环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/quickstart/framework.html#渲染层和逻辑层" class="sidebar-link">渲染层和逻辑层</a></li></ul></li><li><a href="/framework/quickstart/transform.html" class="sidebar-link">小程序转快应用light版</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/quickstart/transform.html#使用方法" class="sidebar-link">使用方法</a></li><li class="sidebar-sub-header"><a href="/framework/quickstart/transform.html#参数说明" class="sidebar-link">参数说明</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/framework/app-service" class="sidebar-heading clickable"><span>逻辑层</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/framework/view" class="sidebar-heading clickable router-link-active open"><span>渲染层</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/view/event.html" class="active sidebar-link">事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/view/event.html#事件使用示例" class="sidebar-link">事件使用示例</a></li><li class="sidebar-sub-header"><a href="/framework/view/event.html#使用-qjs-函数响应事件" class="sidebar-link">使用 QJS 函数响应事件</a></li><li class="sidebar-sub-header"><a href="/framework/view/event.html#事件详解" class="sidebar-link">事件详解</a></li></ul></li><li><a href="/framework/view/interactive-animation.html" class="sidebar-link">QJS响应事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/view/interactive-animation.html#qjs-响应事件" class="sidebar-link">QJS 响应事件</a></li></ul></li><li><a href="/framework/view/component.html" class="sidebar-link">基础组件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/framework/view/animation.html" class="sidebar-link">动画</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/view/animation.html#常用的动画方式：" class="sidebar-link">常用的动画方式：</a></li><li class="sidebar-sub-header"><a href="/framework/view/animation.html#动画事件" class="sidebar-link">动画事件</a></li></ul></li><li><a href="/framework/view/css.html" class="sidebar-link">样式</a></li><li><a href="/framework/view/resizable.html" class="sidebar-link">响应显示区域变化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/view/resizable.html#显示区域变化事件" class="sidebar-link">显示区域变化事件</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自定义组件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>功能模块</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h1> <p>事件将用户在渲染层的操作，反馈到逻辑层，触发对应的事件处理函数，进而响应用户的交互。事件对象可以传递额外的数据，如 id, dataset, touches。</p> <h2 id="事件使用示例"><a href="#事件使用示例" class="header-anchor">#</a> 事件使用示例</h2> <ul><li>在组件中绑定一个事件处理函数，如<code>bindtap=&quot;handleTap&quot;</code></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>testView<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-hi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>QuickApp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>在相应的 Page 定义中编写事件处理函数，参数是事件对象 event。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">handleTap</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>打印的 event 结构如下：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tap&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timeStamp&quot;</span><span class="token operator">:</span> <span class="token number">868</span><span class="token punctuation">,</span>
  <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;testView&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dataset&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;hi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;QuickApp&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;currentTarget&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;testView&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dataset&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;hi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;QuickApp&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;detail&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
    <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token number">36</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;touches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;identifier&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pageX&quot;</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pageY&quot;</span><span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
      <span class="token property">&quot;clientX&quot;</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
      <span class="token property">&quot;clientY&quot;</span><span class="token operator">:</span> <span class="token number">36</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;changedTouches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;identifier&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pageX&quot;</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pageY&quot;</span><span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
      <span class="token property">&quot;clientX&quot;</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
      <span class="token property">&quot;clientY&quot;</span><span class="token operator">:</span> <span class="token number">36</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="使用-qjs-函数响应事件"><a href="#使用-qjs-函数响应事件" class="header-anchor">#</a> 使用 QJS 函数响应事件</h2> <p>使用 QJS 函数处理事件这种情况下，QJS 函数接受 2 个参数，第一个是 event 对象，event 除了有上面基本的属性外，还具有一个 <code>instance</code> 属性；第二个参数是 <code>ownerInstance</code>，和<code>event.instance</code> 一样是一个 <code>ComponentDescriptor</code> 对象。</p> <p>代码示例：</p> <ul><li>在 qxml 中绑定 QJS 函数。</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>qjs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>qjs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./test.qjs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>qjs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>testView<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-hi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>QuickApp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{qjs.handleTap}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> Click Button <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>注意：绑定的 QJS 函数必须用{{}}括起来</strong></p> <ul><li>test.qjs 文件实现 handleTap 函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleTap</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> ownerInstance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tap button'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  handleTap<span class="token punctuation">:</span> handleTap
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>ComponentDescriptor</code> 对象拥有一些方法，可以设置组件的样式等。 <a href="/framework/view/interactive-animation.html">更多详情请参考文档</a>。</p> <h2 id="事件详解"><a href="#事件详解" class="header-anchor">#</a> 事件详解</h2> <h3 id="事件分类"><a href="#事件分类" class="header-anchor">#</a> 事件分类</h3> <p>快应用渲染层中事件分为冒泡事件和非冒泡事件：</p> <ol><li>冒泡事件是指当一个组件上的事件被触发后，该事件会向父节点传递。</li> <li>非冒泡事件是指当一个组件上的事件被触发后，该事件不会向父节点传递。</li></ol> <p>冒泡事件列表：</p> <table><thead><tr><th>类型</th> <th>触发条件</th></tr></thead> <tbody><tr><td>touchstart</td> <td>手指触摸动作开始</td></tr> <tr><td>touchmove</td> <td>手指触摸后移动</td></tr> <tr><td>touchcancel</td> <td>手指触摸动作被打断，如来电提醒，弹窗</td></tr> <tr><td>touchend</td> <td>手指触摸动作结束</td></tr> <tr><td>tap</td> <td>手指触摸后马上离开</td></tr> <tr><td>longpress</td> <td>手指触摸后，超过 350ms 再离开，如果指定了事件回调函数并触发了这个事件，tap 事件将不被触发</td></tr> <tr><td>longtap</td> <td>手指触摸后，超过 350ms 再离开（推荐使用 longpress 事件代替）</td></tr> <tr><td>transitionend</td> <td>会在 transition 或 qa.createAnimation 动画结束后触发</td></tr> <tr><td>animationstart</td> <td>会在一个 animation 动画开始时触发</td></tr> <tr><td>animationiteration</td> <td>会在一个 animation 一次迭代结束时触发</td></tr> <tr><td>animationend</td> <td>会在一个 animation 动画完成时触发</td></tr></tbody></table> <p><strong>注：其他事件如无特殊声明都是非冒泡事件，如 <a href="/component/form.html">form</a> 的<code>submit</code>事件，<a href="/component/input.html">input</a> 的<code>input</code>事件，<a href="/component/scroll-view.html">scroll-view</a> 的<code>scroll</code>事件</strong></p> <h3 id="事件绑定和冒泡"><a href="#事件绑定和冒泡" class="header-anchor">#</a> 事件绑定和冒泡</h3> <p>事件绑定的写法和组件的属性相同。</p> <ul><li>key 以<code>bind</code>或<code>catch</code>开头，后面拼接事件的类型，如<code>bindtap</code>、<code>catchtouchstart</code>。<code>bind</code>和<code>catch</code>后也可以紧跟一个冒号，如<code>bind:tap</code>、<code>catch:touchstart</code>，作用一致。</li> <li>value 是一个字符串，需要在对应的 Page 中定义同名的函数。否则当触发事件的时候会报错。</li> <li>bind 与 catch 的区别：bind 事件绑定不会阻止冒泡事件向上冒泡，而 catch 则会。</li></ul> <p>代码示例：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  view1
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    view2
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      view3
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>执行效果：</p> <ul><li>点击 view3 会先后调用<code>handleTap3</code>和<code>handleTap2</code>(这是因为 tap 事件会冒泡到 view2，而 view2 阻止了 tap 事件冒泡，不再向父节点 view1 传递)</li> <li>点击 view2 只触发<code>handleTap2</code></li> <li>点击 view1 只触发<code>handleTap1</code></li></ul> <h3 id="事件的捕获阶段"><a href="#事件的捕获阶段" class="header-anchor">#</a> 事件的捕获阶段</h3> <p>捕获阶段位于冒泡阶段之前，且在捕获阶段中，事件到达节点的顺序与冒泡阶段相反。捕获阶段监听事件，可以采用<code>capture-bind</code>、<code>capture-catch</code>关键字，后者将中断捕获阶段和取消冒泡阶段。</p> <p>示例代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view1<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap1<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  view1
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view3<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap3<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    view3
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>执行效果：</p> <ul><li>点击 view3 会先后调用<code>handleTap2</code>、<code>handleTap4</code>、<code>handleTap3</code>、<code>handleTap1</code></li></ul> <p>示例代码：(上面代码中的第一个<code>capture-bind</code>改为<code>capture-catch</code>)</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view1<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap1<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">capture-catch:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  view1
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>view3<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap3<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleTap4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    view3
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>执行效果：</p> <ul><li>点击 view3 只触发<code>handleTap2</code></li></ul> <h3 id="事件对象"><a href="#事件对象" class="header-anchor">#</a> 事件对象</h3> <p>当组件触发事件时，逻辑层绑定的处理函数会收到一个事件对象。</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>type</td> <td>String</td> <td>事件类型</td></tr> <tr><td>timeStamp</td> <td>Integer</td> <td>事件生成时的时间戳</td></tr> <tr><td><a href="#target">target</a></td> <td>Object</td> <td>触发事件的组件的属性值集合</td></tr> <tr><td><a href="#currenttarget">currentTarget</a></td> <td>Object</td> <td>当前组件的属性值集合</td></tr> <tr><td><a href="#detail">detail</a></td> <td>Object</td> <td>自定义事件对象额外的信息</td></tr> <tr><td><a href="#touches">touches</a></td> <td>Array</td> <td>触摸事件，当前停留在屏幕中的触摸点信息的数组</td></tr> <tr><td><a href="#changedTouches">changedTouches</a></td> <td>Array</td> <td>触摸事件，当前变化的触摸点信息的数组</td></tr></tbody></table> <p>各属性详细信息如下。</p> <h3 id="target"><a href="#target" class="header-anchor">#</a> target</h3> <p>触发事件的源组件。</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>id</td> <td>String</td> <td>触发事件的组件 id</td></tr> <tr><td><a href="#dataset">dataset</a></td> <td>Object</td> <td>触发事件的组件上由 <code>data-</code> 开头的自定义属性组成的集合</td></tr></tbody></table> <h3 id="currenttarget"><a href="#currenttarget" class="header-anchor">#</a> currentTarget</h3> <p>事件绑定的当前组件。</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>id</td> <td>String</td> <td>当前组件的 id</td></tr> <tr><td><a href="#dataset">dataset</a></td> <td>Object</td> <td>当前组件上由<code>data-</code>开头的自定义属性组成的集合</td></tr></tbody></table> <p><strong>说明： target 和 currentTarget 可以参考上例中，点击 view3 时，<code>handleTap3</code> 收到的事件对象 target 和 currentTarget 都是 view3，而 <code>handleTap2</code> 收到的事件对象 target 就是 view3，currentTarget 就是 view2。</strong></p> <h3 id="dataset"><a href="#dataset" class="header-anchor">#</a> dataset</h3> <p>在组件节点中可以定义一些自定义数据，触发事件时会传入回调中处理。</p> <p>在 QXML 中，这些自定义数据以 <code>data-</code> 开头，多个单词由连字符 <code>-</code> 连接。这种写法中，连字符写法会转换成驼峰写法，而大写字符会自动转成小写字符。如：</p> <ul><li><code>data-custom-value</code> ，最终会呈现为 <code>event.currentTarget.dataset.customValue</code> ；</li> <li><code>data-customValue</code> ，最终会呈现为 <code>event.currentTarget.dataset.customvalue</code> 。</li></ul> <h3 id="touches"><a href="#touches" class="header-anchor">#</a> touches</h3> <p>touches 是一个数组，每个元素为一个 Touch 对象。 表示当前停留在屏幕上的触摸点。另外 canvas 触摸事件中携带的 touches 是 CanvasTouch 数组。</p> <h4 id="touch-对象"><a href="#touch-对象" class="header-anchor">#</a> Touch 对象</h4> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>identifier</td> <td>Number</td> <td>触摸点的标识符</td></tr> <tr><td>pageX, pageY</td> <td>Number</td> <td>距离文档左上角的距离，文档的左上角为原点 ，横向为 X 轴，纵向为 Y 轴</td></tr> <tr><td>clientX, clientY</td> <td>Number</td> <td>距离页面可显示区域（屏幕除去导航条）左上角距离，横向为 X 轴，纵向为 Y 轴</td></tr></tbody></table> <h4 id="canvastouch-对象"><a href="#canvastouch-对象" class="header-anchor">#</a> CanvasTouch 对象</h4> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>identifier</td> <td>Number</td> <td>触摸点的标识符</td></tr> <tr><td>x, y</td> <td>Number</td> <td>距离 Canvas 左上角的距离，Canvas 的左上角为原点 ，横向为 X 轴，纵向为 Y 轴</td></tr></tbody></table> <h3 id="changedtouches"><a href="#changedtouches" class="header-anchor">#</a> changedTouches</h3> <p>changedTouches 数据格式同 touches。 表示有变化的触摸点，如从无变有（touchstart），位置变化（touchmove），从有变无（touchend、touchcancel）。</p> <h3 id="detail"><a href="#detail" class="header-anchor">#</a> detail</h3> <p>自定义事件数据，详见<a href="../../component">组件</a>定义中各个事件的定义。</p> <p>点击事件的<code>detail</code> 带有的 x, y 同 pageX, pageY 代表距离文档左上角的距离。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"></p><div class="prev page-navigator">
      ←
      <div class="navigation-mark"><span class="navigation-flag">Previous</span> <a href="/framework/app-service/api.html" class="prev router-tag" style="pointer-events:none;">api</a></div></div> <div class="next page-navigator"><div class="navigation-mark"><span class="navigation-flag">Next</span> <a href="/framework/view/interactive-animation.html" class="next router-tag" style="pointer-events:none;">QJS响应事件</a></div>→
    </div> <p></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.2978aa4c.js" defer></script><script src="/assets/js/4.f7bb38b0.js" defer></script><script src="/assets/js/454.edfe2275.js" defer></script><script src="/assets/js/8.31dc05a6.js" defer></script>
  </body>
</html>
